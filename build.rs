use cbindgen::{
  Config,
  Error,
  Language,
};

extern crate cbindgen;

fn generate_header(crate_path: &'static str) -> Result<(), Error> {
  let output_file = format!("{}/tinyalloc.h", crate_path);

  let config = Config {
    language: Language::C,
    include_guard: Some("TINYALLOC_H".to_string()),
    autogen_warning: Some(
      "/*\n * This file is autogenerated by cbindgen.\n * Do not modify this file directly.\n */"
        .to_string(),
    ),
    usize_is_size_t: true,
    ..Default::default()
  };

  cbindgen::generate_with_config(crate_path, config)?
    .write_to_file(output_file);

  Ok(())
}

fn main() {
  let crate_path = env!("CARGO_MANIFEST_DIR");
   
  generate_header(crate_path).expect("Unable to generate bindings");
}
